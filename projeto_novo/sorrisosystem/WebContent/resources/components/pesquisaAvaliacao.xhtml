<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:util="http://java.sun.com/jsf/composite/components"
	xmlns:sec="http://www.springframework.org/security/facelets/tags"
	xmlns:composite="http://java.sun.com/jsf/composite">





<h:form id="formPesquisa" prependId="false">
	<composite:interface displayName="interfacePesquisa"
		name="interfacePesquisa">
		<composite:attribute name="managedBeanView" required="true" />
		<composite:attribute name="ocultaNovo" required="true" />
		<composite:attribute name="menuImpressao" required="false"
			default="false" />
		<composite:attribute name="nomePesquisa" required="true" />
		<composite:attribute name="colunasGridDataTableList" required="true" />
	</composite:interface>

	<composite:implementation>
		<c:set var="isCadastro" value="true" scope="view" />

		<h:panelGrid columns="3">
			<h:column rendered="#{cc.attrs.ocultaNovo}">
				<p:commandButton value="Novo" id="buttonNovoRegistro"
					style="height:40px;width:100px;background:#CDCDC1;border: 1px solid #FFFFFF;"
					ajax="false" immediate="true"
					action="#{cc.attrs.managedBeanView.novo()}" />
			</h:column>
			<h:column rendered="#{cc.attrs.menuImpressao}">
				<util:menuImpressao bean="#{cc.attrs.managedBeanView}">
				</util:menuImpressao>
			</h:column>
			<h:column>
				<p:calendar id="Data"
					value="#{cc.attrs.managedBeanView.data1}" mode="inline"
					
					
					
					process="@this, panelGridPesquisa"
										
					locale="pt">
					
					<p:ajax event="dateSelect" listener="#{cc.attrs.managedBeanView.onDateSelect}"
						update=":formTemplate:msg, tableResult" />
				</p:calendar>
			</h:column>
		</h:panelGrid>
		<p:spacer height="20px" />
		<p:panel id="panelPesquisa" header="#{cc.attrs.nomePesquisa}">
			<h:panelGrid columns="7" id="panelGridPesquisa">
				<h:outputLabel for="campo" id="labelCampo" value="Campo: " />
				<p:selectOneMenu style="width: 150px;" id="campo"
					onchange="addMascaraPesquisa(this.value);"
					value="#{cc.attrs.managedBeanView.objetoCampoConsultaSelecionado}">
					<f:selectItems var="campoPesquisaSelecionado"
						itemLabel="#{campoPesquisaSelecionado.descricao}"
						itemValue="#{campoPesquisaSelecionado.tipoClass}"
						id="itensCampoPesquisa"
						value="#{cc.attrs.managedBeanView.listaCampoPesquisa}">
					</f:selectItems>
				</p:selectOneMenu>
				<h:outputLabel for="condicao" id="labelCondicao" value="Onde: "
					rendered="true" />
				<p:selectOneMenu id="condicao" style="width: 150px;"
					value="#{cc.attrs.managedBeanView.condicaoPesquisaSelecionado}"
					rendered="false" disabled="false">
					<f:selectItems id="itensCondicao"
						value="#{cc.attrs.managedBeanView.listaCondicaoPesquisa}">
					</f:selectItems>

				</p:selectOneMenu>

				<p:inputText id="valorPesquisa" immediate="false"
					onblur="validarCampoPesquisa(event);" styleClass="valorPesquisa"
					maxlength="65" onkeypress="executaPesquisaComEnter(event, this);"
					required="false" requiredMessage="Informe o valor do filtro."
					value="#{cc.attrs.managedBeanView.valorPesquisa}" />

				<p:commandButton id="buttonPesquisar" value="Filtrar" ajax="true"
					actionListener="#{cc.attrs.managedBeanView.consultarEntidade}"
					process="@this, panelGridPesquisa"
					oncomplete="addFocoAoCampo('valorPesquisa');"
					onsuccess="addFocoAoCampo('valorPesquisa');"
					update=":formTemplate:msg, tableResult">
				</p:commandButton>
				<p:column></p:column>


			</h:panelGrid>
		</p:panel>


		<p:spacer />


		<p:dataTable id="tableResult" value="#{cc.attrs.managedBeanView.list}"
			var="objeto" emptyMessage="Não existem valores a serem exibidos!"
			rows="10" paginatorPosition="bottom" paginator="true" rendered="true"
			lazy="true"
			paginatorTemplate="{FirstPageLink} {PreviousPageLink} 
								{PageLinks} {NextPageLink} {LastPageLink}
								{RowsPerPageDropdown}">





			<ui:include src="#{cc.attrs.colunasGridDataTableList}" />

		</p:dataTable>
		<script type="text/javascript" charset="UTF-8">
			var idCampo = getValorElementPorIdJQuery('campo');
			var idCampoCondicao = getValorElementPorIdJQuery('condicao');
			var idPesquisa = getValorElementPorIdJQuery('valorPesquisa');

			$(idPesquisa).keypress(permitNumber);

			$(idCampo + ' :nth-child(1)').prop('selected', true);
			$(idCampoCondicao + ' :nth-child(1)').prop('selected', true);
			$(idPesquisa).val('');

			addMascaraPesquisa($(idCampo).val());

			addFocoAoCampo('valorPesquisa');

			//chama o pesquisar ao dar enter na pesquisa
			function executaPesquisaComEnter(event, button) {
				if (event.keyCode == 13) {
					event.preventDefault();
					addFocoAoCampo('buttonPesquisar');

					var buttonPesquisar = getValorElementPorIdJQuery('buttonPesquisar');
					$(buttonPesquisar).click();
				}
			}
		</script>
		<script type="text/javascript">
			PrimeFaces.locales['pt'] = {
				closeText : 'Fechar',
				prevText : 'Anterior',
				nextText : 'Próximo',
				monthNames : [ 'Janeiro', 'Fevereiro', 'Março', 'Abril',
						'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro',
						'Outubro', 'Novembro', 'Dezembro' ],
				monthNamesShort : [ 'Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun',
						'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez' ],
				dayNames : [ 'Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta',
						'Sexta', 'Sábado' ],
				dayNamesShort : [ 'Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex',
						'Sáb' ],
				dayNamesMin : [ 'D', 'S', 'T', 'Q', 'Q', 'S', 'S' ],
				weekHeader : 'Semana',
				weekNumberTitle : 'Sm',
				firstDay : 0,
				isRTL : false,
				showMonthAfterYear : false,
				yearSuffix : '',
				timeOnlyTitle : 'Só Horas',
				timeText : 'Tempo',
				hourText : 'Hora',
				minuteText : 'Minuto',
				secondText : 'Segundo',
				currentText : 'Começo',
				ampm : false,
				month : 'Mês',
				week : 'Semana',
				day : 'Dia',
				allDayText : 'Todo o Dia',
			};
		</script>

	</composite:implementation>
</h:form>

</html>